"use strict";function fhwMD(e,l){let t=[],i=[],r={},n=l.autoid??!1,o=l.mathjax??!1;const a={defLi:new RegExp(/^ *: /g),footnote:new RegExp(/(?<footnote>^ *\[\^(?<bez>[\d\w ]+)\]: )/),fCode:new RegExp(/^ *```.*/),idReg:new RegExp(/{#(?<id>.+)}/),list:new RegExp(/^ *[-+*] |^ *\d+\. /),mail:new RegExp(/<[a-zA-Z0-9.!#$%&’*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*>/),ol:new RegExp(/^ *\d+. /),tag:new RegExp(/<(?<tag>.*?)>/),th:new RegExp(/^ *[\| ]*.*\|.*/),ul:new RegExp(/^ *[-\*\+] /),url:new RegExp(/<https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()!@:%_\+.~#?&\/\/=]*)>/),refLink:new RegExp(/^\[(?<num>.*)\]: *<*(?<link>.*)$/),refTitle:new RegExp(/<*(?<link>.*)[ >]*["'(](?<title>.*)["')] *$/)},p=(e,l)=>e.match(new RegExp("^"+l+"*"),l)[0].length;function c(e){return e.replaceAll(/[&<>'"]/g,(function(e){return{"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"}[e]||e}))}function f(e){return/\S+@\S+\.\S+/.test(e)}function s(e){return!!new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(e)}const d=e=>{let l=e,t=0;return{g:e=>l[t+e]??!1,i:()=>t<l.length,n:()=>l[t++]??!1,c:()=>l[t]??!1,f:()=>t-=t>0,p:e=>{l.push(e),t=l.length-1},a:()=>l,change:e=>l[t]=e,length:()=>l.length,o:()=>l.pop()??!1,last:()=>l[l.length-1]??!1,after:e=>l.splice(t+1,0,e),e:()=>p(l[t]," "),reset:()=>{t=0},deleteAll:()=>{l=[]},hasData:()=>l.length>0,find:e=>l.includes(e),findIdx:e=>-1!==l.indexOf(e)&&l.indexOf(e),oo:e=>{let t="";for(let i=0;i<e;i++){let e=l.pop()??!1;t+=e||""}return t},b:()=>t,d:e=>{t=e}}},h=e=>{e=e.replaceAll(/\t/g,"    ");let l=d(e.split(/\r?\n|\r|\n/g)),i=d([]);i.h=(e=0)=>i.g(e).h??!1,i.v=(e=0)=>i.g(e).v??!1,i.e=(e=0)=>i.g(e).k??!1,i.l=(e=0)=>i.g(e).l??!1,i.N=e=>i.c().h=e,i.O=e=>i.c().l=e,i.P=e=>i.c().v=e,i.add=(e="",l="",t=0,r=0,n="",o="")=>i.p({h:e,v:l,k:t,l:r,hId:n,codeClass:o});let c=[];c.h=(e,l,t)=>{let r=p(l.trim(),"#");r>6&&(r=6);let o=l.match(a.idReg)?.groups.id.replaceAll(" ","-")??!1;o||1!=n||(o=l.trim().slice(r).trim().toLowerCase(),o=o.replace(/[^a-zA-Z-0-9\s]/g,""),o=o.replaceAll(" ","-")),l=l.slice(t).trim().replace(a.idReg,""),i.add(e,l,t,r,o)},c.h1=(e,l,t)=>{if("p"==i.h())return l="# "+i.v(),i.o(),void i.add("h",l,t,1);i.add("p",l,t)},c.h2=(e,l,t)=>{if("p"==i.h())return l="# "+i.v(),i.o(),void i.add("h",l,t,2);i.add("hr",l,t)},c.hr=(e,l,t)=>{i.p({h:e,v:l,k:t})},c.table=(e,t,r)=>{let n=a.th.exec(i.v()),o=a.th.exec(l.g(1));if(n&&o)for(i.N("table"),i.p({h:e,v:t,k:r}),l.n();l.i();){if(!a.th.exec(l.c())){l.f();break}i.add(e,l.c(),r),l.n()}else i.add("p",t,r)},c.blockquote=(e,l,t)=>{let r=p(l,">");l=l.slice(t+r+1),i.p({h:e,v:l,k:t,l:r})},c.code=(e,l,t)=>{i.add(e,l.slice(4),t)},c.fcode=(e,t,r)=>{let n=l.e(),o=t.trimStart().slice(3).trim();for(l.n();l.i()&&!a.fCode.exec(l.c());){if(l.e()<n){l.f();break}t=l.c().slice(n),i.add("code",l.c().slice(n),l.e()-n,null,null,o),l.n()}},c.blank=(e,l,t)=>{i.h!=e&&i.p({h:e,v:l,k:t})},c.p=(e,l,t)=>{i.p({h:e,v:l,k:t})},c.list=(e,t,r)=>{let n=0,o=0;for(;l.i();){if(a.list.exec(l.c())&&(n=l.e()+2),0==l.e()&&!a.list.exec(l.c())&&""==l.c()){l.f();break}o=l.e()>n?n:l.e(),i.add(e,l.c().slice(o),l.e()),l.n()}"list"==i.h()&&""==i.v()&&i.N("blank")},c.html=(e,l,t)=>{let r=a.tag.exec(l)?.groups.tag;s(encodeURI(r))&&(e="p"),f(r)&&(e="p"),i.p({h:e,v:l,k:t})},c.deflist=(e,t,r)=>{let n="p"==i.h(),o=l.e(),p="";if(n)for(i.N("deflist"),i.O("dt");l.i();){for(;l.e()>o;)i.add(e,l.c(),r,"ddchild"),l.n();if(!l.c().match(/^ *: /g)){l.f();break}t=l.c().slice(r),p="dd",i.p({h:e,v:t,l:p,k:r}),l.n()}else for(;l.i();){if(!l.c().match(a.defLi)){l.f();break}i.add("p",l.c().slice(r),r),l.n()}},c.reflink=(e,l,i)=>{let r="",n="",o="",p=a.refLink.exec(l);p&&(r=p.groups.num,n=p.groups.link.trim());let c=a.refTitle.exec(p.groups.link);c&&(n=c.groups.link.trim(),o=c.groups.title.trim()),t[r.replaceAll(" ","-")]={linkUrl:n,linkTitel:o}},c.footnote=(e,t,n)=>{let o=t.match(a.footnote).groups.bez;r[o]=Object.keys(r).length+1,t=t.replace(a.footnote,"");let p="parent";i.p({h:e,v:t,k:n,l:p,footName:o});let c=!1;for(l.n();l.i()&&(c||(c=l.e()),""!=l.c())&&!l.c().match(a.footnote)&&l.e()>=c&&0!=l.e();)t=l.c().slice(c),p="child",n=l.e()-c,i.p({h:e,v:t,k:n,l:p,footName:o}),l.n();r[o],i.P(i.v()+`[&#9166;](#footnoteret-${o} "zurück")`),l.f()},c.mathjax=(e,t,r)=>{let n=/^ *\$\$$/,o=l.e();for(l.n();l.i()&&!l.c().match(n);){if(l.e()<o){l.f();break}l.c().slice(o),i.add("mathjax",l.c().slice(o),l.e()-o,null,null,null),l.n()}};const h=d([]);h.p("(?<code>^ {4,})"),h.p("(?<h>^ *#+)"),h.p("(?<h1>^ *===+ *$)"),h.p("(?<h2>^ *---+ *$)"),h.p("(?<hr>^ *[_*]{3,} *$)"),h.p("(?<table>^ *[\\| ]*[ -:]+\\|.*)"),h.p("(?<fcode>^ *```.* *)"),h.p("(?<list>^ *[-+*] |^ *\\d+\\. )"),h.p("(?<html>^ *<.*?>)"),h.p("(?<blockquote>^ *>+ *)"),h.p("(?<blank>^ *$)"),h.p("(?<deflist>^ *: )"),h.p("(?<footnote>^ *\\[\\^(?<bez>[\\d\\w ]+)\\]: )"),h.p("(?<reflink>^\\[.*\\]:)"),1==o&&h.p("(?<mathjax>^ *\\$\\$$)"),h.p("(?<p>^.*$)");const g=new RegExp(h.a().join("|")),u=e=>{let l=g.exec(e);return l?Object.keys(l.groups).find((e=>void 0!==l.groups[e])):"p"};for(;l.i();){let e=l.c(),t=u(e),i=l.e();c[t](t,e,i),l.n()}return i.reset(),i},g=e=>{const l=e=>g(h(e));let t=d([]),r=[];for(r.h=e=>{let l="";e.hId&&(l=` id="${e.hId.replaceAll(" ","-")}"`),t.p(`<h${e.l}${l}>${u(e.v.slice(e.l).trim())}</h${e.l}>`)},r.blank=()=>{},r.p=l=>{if("p"==e.h(-1)){t.o();let i=e.v(-1).replace(/  $/,"<br>")+" ";e.P(i+l.v)}t.p(`<p>${u(l.v)}</p>`)},r.hr=()=>t.p("<hr>"),r.code=l=>{let i="";for(l.codeClass&&(i=` class="language-${l.codeClass} ${l.codeClass}"`),t.p(`<pre><code${i}>${c(l.v)}`),e.n();e.i();){if("code"!==e.h()){e.f();break}t.p(c(e.v())),e.n()}t.p("</code></pre>")},r.mathjax=l=>{for(t.p('<div class="mdpmath">$$'),t.p(l.v),e.n();e.i();){if("mathjax"!==e.h()){e.f();break}t.p(e.v()),e.n()}t.p("$$</div>")},r.list=()=>{let i=[],r=0,n=d([]),o=d([]),p="";if(a.ul.exec(e.v())&&(p="ul"),a.ol.exec(e.v())&&(p="ol"),t.p(`<${p}>`),o.p(`</${p}>`),n.p(e.e()),e.g(1)){for(i.push(e.v().replace(a.list,"")),e.n();e.i()&&"list"===e.h();){if(a.list.exec(e.v())&&(t.p("<li>"),1==i.length?t.p(u(i[0])):(i.length>1&&i[1]&&i[1].match(a.list)&&(t.p(u(i[0])),i.shift()),t.p(l(i.join("\n")))),i=[],e.e()>n.last()&&(a.ul.exec(e.v())&&(p="ul"),a.ol.exec(e.v())&&(p="ol"),t.p(`<${p}>`),o.p(`</${p}>`),n.p(e.e())),e.e()<n.last())){if(n.find(e.e()))r=n.length()-n.findIdx(e.e())-1;else{let l=0;for(;n.g(l)>e.e();)l--;r=-1*l-1}for(let e=0;e<r;e++)n.o(),t.p(o.o())}i.push(e.v().replace(a.list,"")),e.n()}for(t.p("<li>"),1==i.length?t.p(u(i[0])):(i.length>1&&i[1]&&i[1].match(a.list)&&(t.p(u(i[0])),i.shift()),t.p(l(i.join("\n"))));o.last();)t.p(o.o());e.f()}else t.p("<li>"+u(e.v().replace(a.list,""))+o.o())},r.table=()=>{let l=(()=>{let l=e.v(1).replace(/^ *\||\| *$/g,"").split("|");return l.forEach(((e,t)=>{let i=e.trim();l[t]="",i.match(/^:.*:$/)&&(l[t]=' style="text-align: center;"'),i.match(/^:-*$/)&&(l[t]=' style="text-align: left;"'),i.match(/^-*:$/)&&(l[t]=' style="text-align: right;"')})),l})(),i=e.v().replace(/^ *\||\| *$/g,"").split("|");e.n(),e.n();let r=[];for(;e.i();){if("table"!==e.h()){e.f();break}r.push(e.v().replace(/^ *\||\| *$/g,"").split("|")),e.n()}let n=i.length;r.forEach((e=>{e.length>n&&(n=e.length)})),t.p("<table>"),t.p("<thead><tr>");for(let e=0;e<n;e++){let r=i[e]??"",n=l[e]??"";t.p(`<th${n}>`),t.p(u(r.trim())),t.p("</th>")}t.p("</tr></thead>"),t.p("<tbody>"),r.forEach((e=>{t.p("<tr>");for(let i=0;i<n;i++){let r=e[i]??"",n=l[i]??"";t.p(`<td${n}>`),t.p(u(r.trim())),t.p("</td>")}t.p("</tr>")})),t.p("</tbody>"),t.p("</table>")},r.blockquote=()=>{let i="",r=d([]);t.p("<blockquote>"),r.p("</blockquote>");let n=e.l();for(;e.i();){if("blockquote"!==e.h()){e.f();break}if(n!==e.l()){t.p(l(i));let o=e.l()-n;if(o>0)for(let e=0;e<o;e++)t.p("<blockquote>"),r.p("</blockquote>");else t.p(r.oo(o*=-1));n=e.l(),i=""}i+=e.v()+"\n",e.n()}for(t.p(l(i));r.last();)t.p(`${r.o()}`)},r.html=()=>{t.p(e.v())},r.deflist=()=>{for(t.p("<dl>");e.i();){if("blank"==e.h()&&"deflist"!==e.h(1)){e.f();break}if("deflist"!==e.h()&&"blank"!==e.h()){e.f();break}if("blank"!==e.h()&&("dt"==e.l()&&t.p("<dt>"+u(e.v().replace(/^ *: /,""))+"</dt>"),"dd"==e.l()))if("ddchild"==e.l(1)){let i=[];for(i.push(e.v().replace(/^ *: /,"")),e.n();e.i();){if("ddchild"!==e.l()){t.p("<dd>"),t.p(l(i.join("\n"))),t.p("</dd>"),e.f();break}i.push(e.v()),e.n()}}else t.p("<dd>"+u(e.v().replace(/^ *: /,""))+"</dd>");e.n()}t.p("</dl>")},r.footnote=()=>{let t=[],r=e.c().footName;for(t.push(e.v()),e.n();e.i()&&"child"===e.c().l;)t.push(e.v()),e.n();r=r.replaceAll(" ","-"),i.push(`<li id="footnote-${r}">`+l(t.join("\n"))),e.f()};e.i();)r[e.h()](e.c()),e.n();return t.a().join("\n")},u=e=>{let l=d(e.split("")),i=e,n=d([]),a=d([]),p=d([]);function h(e){return" "==l.g(-1)&&" "==l.g(e)&&(n.p(l.c()),2==e&&(n.p(l.g(1)),l.n()),!0)}function g(e){if(n.last()==`<${e}>`)return n.o(),void a.o();a.find(e)?function(e){for(;p.last()!==e;)n.p(`</${a.last()}>`),p.p(a.o());for(p.o();p.last();)n.p(`<${p.last()}>`),a.p(p.o())}(e):(n.p(`<${e}>`),a.p(e))}function $(){let e=i.substr(l.b());n.p("<code>"),a.p("code");let t=/^(?<!`)`(?!`)(?<code>.*?)(?<!`)`(?!`)/.exec(e);if(t)return n.p(c(t.groups.code)),l.d(l.b()+t[0].length-1),void n.p(`</${a.o()}>`)}function k(){n.p("<code>"),a.p("code"),l.f();let e=i.substr(l.b()),t=/^(?<!`)``(?!`)(?<code>.*?)(?<!`)``(?!`)/.exec(e);if(t)return n.p(c(t.groups.code)),l.d(l.b()+t[0].length-1),void n.p(`</${a.o()}>`)}function b(){let e=i.substr(l.b()),o=e.match(/\[\^(?<flink>[\d\w ]+)\]/);if(o){let e=o[0].length,l=o.groups.flink,t=r[l]??"error";return l=l.replaceAll(" ","-"),[`<sup id=footnoteret-${l}><a href="#footnote-${l}">${t}</a></sup>`,e]}let a=e.match(/^\[!\[(?<imgAlt>.+?)\]\((?<imgUrl>[^ ]+?)( ["'\(](?<imgTitle>.+?)["'\)])?\)\]\((?<linkUrl>.+?)\)/);if(a){let e=a.groups.imgTitle;e=e?` title="${e}"`:"";let l=a.groups.imgAlt;return l=l?` alt="${l}"`:"",[`<a href="${a.groups.linkUrl}"><img src="${a.groups.imgUrl}" ${l}${e}></a>`,a[0].length]}let p=e.match(/^\[(?<linktext>.+?)\]\((?<linkUrl>[^ ]+?)( ["'\(](?<title>.+?)["'\)])?\)/);if(p){let e=p.groups.title;return e=e?` title="${e}"`:"",[`<a href="${encodeURI(p.groups.linkUrl.trim())}"${e}>${u(p.groups.linktext)}</a>`,p[0].length]}let c=e.match(/^\[(?<linktext>.+?)\]\((?<linkUrl>#.+?)( ["'\(](?<title>.+?)["'\)])?\)/);if(c){let e=c.groups.title;return e=e?` title="${e}"`:"",[`<a href="${encodeURI(c.groups.linkUrl.trim().replaceAll(" ","-"))}"${e}>${u(c.groups.linktext)}</a>`,c[0].length]}let f=e.match(/^\[(?<label>.+?)\] ?\[(?<linkRef>.+?)\]/);if(f){let e=f.groups.linkRef.replaceAll(" ","-").toLowerCase();if(t[e]){let l=t[e].linkUrl,i=t[e].linkTitel;return i=""!==i?` title="${i}"`:"",[`<a href="${encodeURI(l.trim())}"${i}>${u(f.groups.label)}</a>`,f[0].length]}}let s=e.match(/^\[(?<label>.+?)\](?!\[)/);if(s){let e=s.groups.label.replaceAll(" ","-").toLowerCase();if(t[e]){let l=t[e].linkUrl,i=t[e].linkTitel;return i=""!==i?` title="${i}"`:"",[`<a href="${encodeURI(l.trim())}"${i}>${u(s.groups.label)}</a>`,s[0].length]}}return n.p(l.c()),[!1,""]}function m(){let e=i.substr(l.b()),r=e.match(/^!\[(?<imgAlt>.+?)\]\((?<imgUrl>[^ ]+?)( ["'\(](?<imgTitle>.+?)["'\)])?\)\)*/);if(r){let e=r.groups.imgTitle;return e=e?` title="${e}"`:"",[`<img src="${encodeURI(r.groups.imgUrl.trim())}" alt="${r.groups.imgAlt}"${e}>`,r[0].length]}let o=e.match(/^!\[(?<label>.+?)\] ?\[(?<linkRef>.+?)\]/);if(o){let e=o.groups.linkRef.replaceAll(" ","-").toLowerCase();if(t[e]){let l=encodeURI(t[e].linkUrl),i=t[e].linkTitel;return[`<img src="${l}" alt="${o.groups.label}" title="${i}">`,o[0].length]}}let a=e.match(/^!\[(?<label>.+?)\](?!\[)/);if(a){let e=a.groups.label.replaceAll(" ","-").toLowerCase();if(t[e]){let l=encodeURI(t[e].linkUrl),i=t[e].linkTitel;return[`<img src="${l}" alt="${a.groups.label}" title="${i}">`,a[0].length]}}return n.p(l.c()),[!1,""]}function v(){let e="",t=1;return[e,t]=function(e,t){let i="";for(;l.g(e)&&l.g(e)!=t;)i+=l.g(e),e++;return[i,e]}(t,">"),l.g(t)&&""!=e?f(encodeURI(e))?(n.p(`<a href="mailto:${e}">${e}</a>`),void l.d(l.b()+t)):s(encodeURI(e))?(n.p(`<a href="${e}">${e}</a>`),void l.d(l.b()+t)):void n.p(l.c()):(n.p(c(l.c())),[!1,""])}function x(){i.substr(l.b());let e=0,t="";for(;l.g(e)&&!" <".includes(l.g(e));)t+=l.g(e),e++;e=-1;let r="";for(;l.g(e)&&!" >".includes(l.g(e));)r=l.g(e)+r,e--;let o=encodeURI(r+t);return s(o)?(l.d(l.b()+t.length-1),n.oo(r.length),void n.p(`<a href="${o}">${r+t}</a>`)):f(o)?(l.d(l.b()+t.length-1),n.oo(r.length),void n.p(`<a href="mailto:${o}">${r+t}</a>`)):void n.p(l.c())}function R(){let e=i.substr(l.b()),t=/^\$\$(?<mathjax>.*?)\$\$/.exec(e);if(t)return n.p(`<span class="mathjax">-$${t.groups.mathjax}$-</span>`),void l.d(l.b()+t[0].length-1);n.p(l.c()),l.n(),n.p(l.c())}for(!function(){for(;l.i();){let e=l.c(),t="*_^=\\`[!<~:@";if(1==o&&(t+="$"),t.includes(e))switch(e){case"*":case"_":if(h(1))break;if("*"==l.g(1)||"_"==l.g(1)){if(h(2))break;l.n(),g("strong")}else g("em");break;case"^":if(h(1))break;g("sup");break;case"~":if(h(1))break;if("~"==l.g(1)){if(h(2))break;l.n(),g("del")}else g("sub");break;case"=":if(h(1))break;if("="==l.g(1)){if(h(2))break;l.n(),g("mark")}else n.p(l.c());break;case"\\":l.i()?(l.n(),"$"==l.c()?n.p("&dollar;"):n.p(c(l.c()))):n.p(l.c());break;case"`":"`"==l.g(1)?(l.n(),k()):$();break;case"[":if(h(1))break;let[e,t]=b();e&&(n.p(e),l.d(l.b()+t-1));break;case"!":if(h(1))break;let[i,r]=m();i&&(n.p(i),l.d(l.b()+r-1));break;case"<":if(h(1))break;v();break;case":":case"@":x();break;case"$":if(h(1))break;"$"==l.g(1)&&R()}else n.p(l.c());l.n()}}();a.last();)n.p(`</${a.o()}>`);return n.a().join("")};let $=h(e),k=g($);return i.length>0?k+"<hr><ol>"+i.join("\n")+"</ol>":k}